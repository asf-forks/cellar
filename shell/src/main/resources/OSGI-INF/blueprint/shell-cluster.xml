<?xml version="1.0" encoding="UTF-8"?>

<blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0" default-activation="lazy">

    <!-- Command Bundle -->
    <command-bundle xmlns="http://karaf.apache.org/xmlns/shell/v1.0.0">
        <command name="cluster/list">
            <action class="net.cellar.shell.ListNodesCommand">
              <property name="clusterManager" ref="clusterManager"/>
            </action>
        </command>

        <command name="cluster/ping">
            <action class="net.cellar.shell.PingCommand">
              <property name="clusterManager" ref="clusterManager"/>
              <property name="executionContext" ref="executionContext"/>
            </action>
        </command>

        <command name="cluster/consume">
            <action class="net.cellar.shell.ConsumeCommand">
              <property name="clusterManager" ref="clusterManager"/>
              <property name="executionContext" ref="executionContext"/>
            </action>
             <completers>
                <ref component-id="allNodesCompleter" />
            </completers>
        </command>

        <command name="cluster/produce">
            <action class="net.cellar.shell.ProduceCommand">
              <property name="clusterManager" ref="clusterManager"/>
              <property name="executionContext" ref="executionContext"/>
            </action>
             <completers>
                <ref component-id="allNodesCompleter" />
            </completers>
        </command>

        <command name="cluster/handler">
            <action class="net.cellar.shell.HandlersCommand">
              <property name="clusterManager" ref="clusterManager"/>
              <property name="executionContext" ref="executionContext"/>
            </action>
             <completers>
                <ref component-id="allNodesCompleter" />
            </completers>
        </command>
    </command-bundle>

    <!-- Reference to the Cluster Manager -->
    <reference id="clusterManager" interface="net.cellar.core.ClusterManager"/>
    <reference id="executionContext" interface="net.cellar.core.command.ExecutionContext"/>

    <!-- Completers -->
    <bean id="allNodesCompleter" class="net.cellar.shell.completers.AllNodeCompleter">
        <property name="clusterManager" ref="clusterManager"/>
    </bean>

</blueprint>
